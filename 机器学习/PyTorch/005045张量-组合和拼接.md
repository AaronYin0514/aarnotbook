---
tags: python ai pytorch 
---

# 张量-组合和拼接

| 函数                                        | 说明                               |
| ------------------------------------------- | ---------------------------------- |
| `torch.cat(seq, dim=0, out=None)`           | 按照已经存在的维度进行拼接         |
| `torch.stack(seq, dim=0, out=None)`         | 按照新的维度进行拼接               |
| `torch.gather(input, dim, index, out=None)` | 在指定维度上按照索引赋值输出tensor |

## cat

按照已经存在的维度进行拼接

```python
import torch

a = torch.zeros((2, 4))
b = torch.ones((2, 4))

out = torch.cat((a, b), dim=0)
'''
tensor([[0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [1., 1., 1., 1.],
        [1., 1., 1., 1.]])
'''
# 解释 按列拼接

out = torch.cat((a, b), dim=1)
'''
tensor([[0., 0., 0., 0., 1., 1., 1., 1.],
        [0., 0., 0., 0., 1., 1., 1., 1.]])
'''
# 解释 按行拼接
```

## stack

按照新的维度进行拼接

```python
a = torch.linspace(1, 6, 6).view(2, 3)
b = torch.linspace(7, 12, 6).view(2, 3)

out = torch.stack((a, b), dim=0)
print(out)
print(out.shape)
'''
tensor([[[ 1.,  2.,  3.],
         [ 4.,  5.,  6.]],

        [[ 7.,  8.,  9.],
         [10., 11., 12.]]])
torch.Size([2, 2, 3])
'''

out = torch.stack((a, b), dim=1)
print(out)
print(out.shape)
'''
tensor([[[ 1.,  2.,  3.],
         [ 7.,  8.,  9.]],

        [[ 4.,  5.,  6.],
         [10., 11., 12.]]])
torch.Size([2, 2, 3])
'''
  
out = torch.stack((a, b), dim=2)
print(out)
print(out.shape)
'''
tensor([[[ 1.,  7.],
         [ 2.,  8.],
         [ 3.,  9.]],

        [[ 4., 10.],
         [ 5., 11.],
         [ 6., 12.]]])
torch.Size([2, 3, 2])
'''
```



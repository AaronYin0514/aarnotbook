---
tags: python ai pytorch 
---

# 张量-创建

## tensor的创建

| 函数                                   | 功能                      |
| -------------------------------------- | ------------------------- |
| `Tensor(*size)`                        | 基础构造函数              |
| `Tensor(data)`                         | 类似`np.array`            |
| `ones(*size)`                          | 全1Tensor                 |
| `zeros(*size)`                         | 全0Tensor                 |
| `eye(*size)`                           | 对角线为1，其它为0        |
| `arange(s,e,step)`                     | 从s到e，步长为step        |
| `linspace(s,e,steps)`                  | 从s到e，均匀切分成steps份 |
| `rand`/`randn(*size)`                  | 均匀/标准分布             |
| `normal(mean,std)`/`uniform_(from,to)` | 正态分布/均匀分布         |
| `randperm(m)`                          | 随机排列                  |

### 基础构造函数

```python
import torch

a = torch.Tensor([[1,2],[3,4]])
print(a)
'''
tensor([[1., 2.],
		[3., 4.]])
'''
print(a.type()) # torch.FloatTensor

a = torch.Tensor(2, 3)
print(a)
print(a.type()) # torch.FloatTensor
```

### 几种特殊tensor

```python
a = torch.ones(2,2)
print(a)
'''
tensor([[1., 1.],
		[1., 1.]])
'''

a = torch.eye(2,2)
print(a)
'''
tensor([[1., 0.],
		[0., 1.]])
'''

b = torch.Tensor(2,3)
b = torch.zeros_like(b)
b = torch.ones_like(b)
print(b)
```

### 随机

- `rand`均匀分布，值$[0, 1)$
- `randn`标准正态分布
- `normal`正态分布，可以传入均值和方差

```python
a = torch.rand(2, 2)
print(a)
'''
tensor([[0.2824, 0.9917],
        [0.1180, 0.9354]])
'''

a = torch.randn(2, 3)
print(a)
'''
tensor([[-0.0031,  0.9527,  2.2528],
        [-2.0334,  0.8677,  1.7947]])
'''

a = torch.normal(mean=0.0, std=torch.rand(5))
print(a) # tensor([-0.1395, -0.1484, -0.2762,  1.6718, -0.2115])

a = torch.normal(mean=torch.rand(5), std=torch.rand(5))
print(a) # tensor([-0.1494,  0.4050,  0.0025,  0.4993,  1.2091])

a = torch.Tensor(2, 2).uniform_(-1, 1)
print(a)
'''
tensor([[-0.2603, -0.4291],
        [ 0.9557,  0.7521]])
'''
```

### 序列

```python
a = torch.arange(0, 10, 1)
print(a) # tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])

a = torch.linspace(2, 10, 3) # 拿到一个等间隔的n个数字（等差数列）
print(a) # tensor([ 2.,  6., 10.])

a = torch.randperm(10)
print(a) # tensor([6, 8, 7, 0, 9, 2, 5, 4, 3, 1])
```

## 对比numpy

```python
import numpy as np
  
a = np.array([[1,2], [3,4]])
print(a)
'''
[[1 2]
 [3 4]]
'''
```



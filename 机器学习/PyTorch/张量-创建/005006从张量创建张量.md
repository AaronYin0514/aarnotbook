## 从张量创建张量

### `torch.clone`

1. **内存分配**: `clone` 会为新张量分配新的内存，确保原始张量和克隆张量在内存中是独立的。
2. **自动计算图**: 克隆的张量会保留原始张量的梯度历史，因此在进行反向传播时，**克隆张量的梯度会影响原始张量的梯度**。

**函数签名**

```python
torch.clone(input) → Tensor
```

**参数**

- **input**: 要克隆的张量。

**示例用法**

在这个示例中，`y` 是 `x` 的克隆，修改 `y` 不会影响 `x` 的值，但在反向传播时，`y` 的变化会影响到 `x` 的梯度。

```python
import torch

# 创建一个张量
x = torch.tensor([[1.0, 2.0], [3.0, 4.0]], requires_grad=True)
# 克隆张量
y = x.clone()
# 对克隆的张量进行操作
y += 1

print("原始张量:", x)
'''
原始张量: tensor([[1., 2.],
        [3., 4.]], requires_grad=True)
'''

print("拷贝张量:", y)
'''
拷贝张量: tensor([[2., 3.],
        [4., 5.]], grad_fn=<AddBackward0>)
'''

# 进行反向传播
loss = y.sum()
loss.backward()

print("原始张量梯度 x:", x.grad)
'''
原始张量梯度 x: tensor([[1., 1.],
        [1., 1.]])
'''
```

### `torch.empty_like`

`torch.empty_like` 是 PyTorch 中用于创建与指定输入张量相同形状和数据类型的未初始化张量的函数。该函数在需要创建一个将来会被填充数据的张量时非常有用，因为它不会为初始化值分配内存。

**函数签名**

```python
torch.empty_like(input, *, dtype=None, layout=None, device=None, requires_grad=False, memory_format=torch.preserve_format) → Tensor
```

**参数**

- **input**: 用于确定新张量形状和数据类型的输入张量。
- **dtype** (可选): 指定返回张量的期望数据类型。如果为 `None`，则默认为输入张量的数据类型。
- **layout** (可选): 指定返回张量的布局方式。如果为 `None`，则默认为输入张量的布局。
- **device** (可选): 指定返回张量的存储设备（CPU或GPU）。如果为 `None`，则默认为输入张量的设备。
- **requires_grad** (可选): 布尔值，指示是否跟踪返回张量上的操作以进行梯度计算。默认为 `False`。
- **memory_format** (可选): 指定返回张量的内存格式。默认为 `torch.preserve_format`。

**示例用法**

```python
import torch

# 创建一个初始张量
a = torch.empty((2, 3), dtype=torch.int32, device='cuda')

# 创建一个与 'a' 形状和数据类型相同的未初始化张量
b = torch.empty_like(a)

print(b)  # 这将打印一个未初始化的张量，形状、数据类型等与 'a' 相同
'''
⚠️ 元素随机不保证
'''
```

### `torch.ones_like`

`torch.ones_like` 是 PyTorch 中用于创建与指定输入张量相同形状和数据类型的全1张量的函数。它的主要功能是生成一个与给定张量具有相同维度和属性的张量，但所有元素都被初始化为1。

**函数签名**

```python
torch.ones_like(input, *, dtype=None, layout=None, device=None, requires_grad=False, memory_format=torch.preserve_format) → Tensor
```

**参数**

- **input**: 作为输入的张量，其形状和数据类型将用于创建新的张量。
- **dtype** (可选): 指定返回张量的期望数据类型。如果为 `None`，则默认为输入张量的数据类型。
- **layout** (可选): 指定返回张量的布局方式。默认为输入张量的布局。
- **device** (可选): 指定返回张量的存储设备（如 CPU 或 GPU）。默认为输入张量的设备。
- **requires_grad** (可选): 布尔值，指示是否跟踪返回张量上的操作以进行梯度计算。默认为 `False`。
- **memory_format** (可选): 指定返回张量的内存格式。默认为 `torch.preserve_format`。

**示例用法**

```python
import torch

# 创建一个张量
my_tensor = torch.tensor([[7., 4., 5.], [2., 8., 3.]])

# 创建一个与 my_tensor 形状相同的全1张量
ones_tensor = torch.ones_like(my_tensor)

print(ones_tensor)  # 输出将是 tensor([[1., 1., 1.], [1., 1., 1.]])
```

### `torch.zero_like`

`torch.zeros_like` 是 PyTorch 中的一个函数，用于创建一个与指定输入张量相同形状和数据类型的全零张量。这个函数非常实用，特别是在需要初始化为零的场景中。

**函数签名**

```python
torch.zeros_like(input, *, dtype=None, layout=None, device=None, requires_grad=False, memory_format=torch.preserve_format) → Tensor
```

**参数**

- **input**: 输入张量，其形状和数据类型将用于创建新的全零张量。
- **dtype** (可选): 指定返回张量的期望数据类型。如果为 `None`，则默认为输入张量的数据类型。
- **layout** (可选): 指定返回张量的布局方式。默认为输入张量的布局。
- **device** (可选): 指定返回张量的存储设备（如 CPU 或 GPU）。默认为输入张量的设备。
- **requires_grad** (可选): 布尔值，指示是否跟踪返回张量上的操作以进行梯度计算。默认为 `False`。
- **memory_format** (可选): 指定返回张量的内存格式。默认为 `torch.preserve_format`。

**示例用法**

```python
import torch

# 创建一个张量
a = torch.tensor([[7., 4., 5.], [2., 8., 3.]])

# 创建一个与 a 相同形状和数据类型的全零张量
b = torch.zeros_like(a)

print(b)  # 输出将是 tensor([[0., 0., 0.], [0., 0., 0.]])
```



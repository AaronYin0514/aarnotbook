---
tags: python ai pytorch 
---

# 张量-切片

| 函数                                                 | 说明                                                      |
| ---------------------------------------------------- | --------------------------------------------------------- |
| `torch.chunk(tensor, chunks, dim=0)`                 | 按照某个维度平均分块（最后一个可能小于平均值）            |
| `torch.split(tensor, split_size_or_sections, dim=0)` | 按照某个维度依照第二个参数给出的list或者int进行分割tensor |

## chunk

按照某个维度平均分块（最后一个可能小于平均值）

```python
a = torch.rand((3, 4))
'''
tensor([[0.2256, 0.5485, 0.3855, 0.6632],
        [0.5469, 0.4389, 0.6311, 0.7021],
        [0.3435, 0.6300, 0.0429, 0.1750]])
'''
out = torch.chunk(a, 2, dim=1)
'''
(tensor([[0.2256, 0.5485],
        [0.5469, 0.4389],
        [0.3435, 0.6300]]), tensor([[0.3855, 0.6632],
        [0.6311, 0.7021],
        [0.0429, 0.1750]]))
'''
```

## split

按照某个维度依照第二个参数给出的`list`或者`int`进行分割tensor

```python
a = torch.rand((10, 4))
'''
tensor([[0.7773, 0.5649, 0.2202, 0.5835],
        [0.1322, 0.6952, 0.8086, 0.0510],
        [0.6199, 0.1423, 0.9704, 0.2059],
        [0.6479, 0.4956, 0.1683, 0.6369],
        [0.9727, 0.4382, 0.5792, 0.2850],
        [0.3309, 0.9957, 0.3236, 0.2325],
        [0.4061, 0.6346, 0.6941, 0.7615],
        [0.2721, 0.9844, 0.4184, 0.9557],
        [0.5636, 0.4595, 0.4898, 0.8100],
        [0.0803, 0.6338, 0.9042, 0.6378]])
'''

out = torch.split(a, 3, dim=0)
'''
(tensor([[0.7773, 0.5649, 0.2202, 0.5835],
        [0.1322, 0.6952, 0.8086, 0.0510],
        [0.6199, 0.1423, 0.9704, 0.2059]]), tensor([[0.6479, 0.4956, 0.1683, 0.6369],
        [0.9727, 0.4382, 0.5792, 0.2850],
        [0.3309, 0.9957, 0.3236, 0.2325]]), tensor([[0.4061, 0.6346, 0.6941, 0.7615],
        [0.2721, 0.9844, 0.4184, 0.9557],
        [0.5636, 0.4595, 0.4898, 0.8100]]), tensor([[0.0803, 0.6338, 0.9042, 0.6378]]))
'''
```

```python
a = torch.rand((10, 4))
'''
tensor([[0.9643, 0.6732, 0.2056, 0.0804],
        [0.9931, 0.2338, 0.1910, 0.4779],
        [0.5307, 0.7807, 0.5853, 0.9446],
        [0.8978, 0.6189, 0.2848, 0.6073],
        [0.6416, 0.6372, 0.2889, 0.4294],
        [0.9909, 0.6859, 0.8831, 0.5113],
        [0.0848, 0.1797, 0.7877, 0.9380],
        [0.6910, 0.8497, 0.1599, 0.0097],
        [0.8018, 0.9514, 0.0396, 0.6123],
        [0.3592, 0.4811, 0.7723, 0.0559]])
'''

out = torch.split(a, [1, 3, 6], dim=0)
'''
(tensor([[0.9643, 0.6732, 0.2056, 0.0804]]), tensor([[0.9931, 0.2338, 0.1910, 0.4779],
        [0.5307, 0.7807, 0.5853, 0.9446],
        [0.8978, 0.6189, 0.2848, 0.6073]]), tensor([[0.6416, 0.6372, 0.2889, 0.4294],
        [0.9909, 0.6859, 0.8831, 0.5113],
        [0.0848, 0.1797, 0.7877, 0.9380],
        [0.6910, 0.8497, 0.1599, 0.0097],
        [0.8018, 0.9514, 0.0396, 0.6123],
        [0.3592, 0.4811, 0.7723, 0.0559]]))
'''
```

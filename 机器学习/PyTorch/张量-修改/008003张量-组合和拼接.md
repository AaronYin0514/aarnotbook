---
tags: python ai pytorch 
---

# 张量-组合拼接复制

| 函数                                          | 说明                   |
| ------------------------------------------- | -------------------- |
| `torch.gather(input, dim, index, out=None)` | 在指定维度上按照索引赋值输出tensor |

## `torch.cat`

`torch.cat` 是用于（沿指定的维度）连接多个张量的函数。所有输入张量必须具有相同的形状，除了连接的维度。

**函数签名**

```python
torch.cat(tensors, dim=0, out=None)
```

**参数**

  - `tensors`: 要连接的张量序列，可以是列表或元组。
  - `dim`: 指定连接的维度，默认为0。
  - `out` (可选): 用于存储结果的张量。

**示例**

基本用法

```python
import torch

# 创建几个张量
a = torch.tensor([[1, 2], [3, 4]])
b = torch.tensor([[5, 6]])

# 沿着第0维连接
result_dim0 = torch.cat((a, b), dim=0)

# 沿着第1维连接
c = torch.tensor([[7], [8]])
result_dim1 = torch.cat((a, c), dim=1)

print("Result along dim 0:\n", result_dim0)
# 输出:
# tensor([[1, 2],
#         [3, 4],
#         [5, 6]])

print("Result along dim 1:\n", result_dim1)
# 输出:
# tensor([[1, 2, 7],
#         [3, 4, 8]])
```

## `torch.stack`

用于将多个张量沿着一个**新维度**进行连接的函数。所有输入张量必须具有相同的形状。

`torch.stack` 与 `torch.cat` 的区别， `torch.stack` 会在指定维度上增加一个新的维度，而 `torch.cat` 则是在已有维度上进行连接，不会增加新维度。

**函数签名**

```python
torch.stack(tensors, dim=0)
```

**参数**

  - `tensors`: 要连接的张量序列，可以是列表或元组。
  - `dim`: 指定插入新维度的位置，默认为0。

**示例**

1. 基本用法

```python
import torch

# 创建几个一维张量
a = torch.tensor([1, 2, 3])
b = torch.tensor([4, 5, 6])
c = torch.tensor([7, 8, 9])

# 使用 torch.stack 连接张量
stacked_tensor = torch.stack([a, b, c])

print("Stacked tensor:\n", stacked_tensor)
# 输出:
# tensor([[1, 2, 3],
#         [4, 5, 6],
#         [7, 8, 9]])
```

2. 指定维度

```python
# 沿着不同的维度进行堆叠
stacked_dim0 = torch.stack([a, b], dim=0)  # 在第0维堆叠
stacked_dim1 = torch.stack([a, b], dim=1)  # 在第1维堆叠

print("Stacked along dim 0:\n", stacked_dim0)
# 输出:
# tensor([[1, 2, 3],
#         [4, 5, 6]])

print("Stacked along dim 1:\n", stacked_dim1)
# 输出:
# tensor([[1, 4],
#         [2, 5],
#         [3, 6]])
```




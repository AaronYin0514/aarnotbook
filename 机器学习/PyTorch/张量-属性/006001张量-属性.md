## 张量-属性

### 形状（Shape）

- **定义**: 张量的形状是指其每个维度的大小。例如，一个形状为 $(3, 4)$ 的张量表示它有3行4列。
- **获取形状**: 在 PyTorch 中，可以通过 `tensor.shape` 或 `tensor.size()` 获取张量的形状。

```python
import torch

a = torch.tensor([[1,2,3], [4,5,6]])
a.shape, a.size()
'''
(torch.Size([2, 3]), torch.Size([2, 3]))
'''
```

### 维度(秩)(Rank)

- **定义**: 张量的秩是指其维度的数量。例如，标量是0维张量，向量是1维张量，矩阵是2维张量。
- **获取秩**: 可以通过 `tensor.ndim` 或 `len(tensor.shape)` 获取张量的秩。

```python
import torch

a = torch.tensor([[1,2,3], [4,5,6]])
a.ndim, a.dim(), len(a.shape)
'''
(2, 2, 2)
'''
```

### 数据类型（Data Type）

**定义**: 张量的数据类型决定了存储在张量中的数据的类型，例如整数、浮点数等。

**常见数据类型**: 

| 数据类型                    | pytorch数据类型                       | 张量类型                   |
| ----------------------- | --------------------------------- | ---------------------- |
| 32-bit floating point   | `torch.float32` or `torch.float`  | `torch.*.FloatTensor`  |
| 64-bit floating point   | `torch.float64` or `torch.double` | `torch.*.DoubleTensor` |
| 16-bit floating point   | `torch.float16` or `torch.half`   | `torch.*.HalfTensor`   |
| 8-bit integer(unsigned) | `torch.uint8`                     | `torch.*.ByteTensor`   |
| 8-bit integer(signed)   | `torch.int8`                      | `torch.*.CharTensor`   |
| 16-bit integer(signed)  | `torch.int16` or `torch.short`    | `torch.*.ShortTensor`  |
| 32-bit integer(signed)  | `torch.int32` or `torch.int`      | `torch.*.IntTensor`    |
| 64-bit integer(signed)  | `torch.int64`  or `torch.long`    | `torch.*.LongTensor`   |
| Boolean                 | `torch.bool`                      | `torch.BoolTensor`     |

**获取数据类型**: 可以通过 `tensor.dtype` 获取张量的数据类型。

```python
import torch

a = torch.tensor([[1,2,3], [4,5,6]])
a.dtype
'''
torch.int64
'''
```

### 设备（Device）

- **定义**: 张量可以存储在不同的设备上，如CPU或GPU。
- **获取设备信息**: 可以通过 `tensor.device` 获取张量所在的设备。

```python
# 将变量指定到GPU上进行存储
dev = torch.device("cuda:0")
# 将变量指定到CPU上进行存储
dev = torch.device("cpu")
# Mac arm64芯片
dev = torch.device("mps")

a = torch.tensor([2,2], dtype=torch.int32, device=dev)
```

```python
import torch

x = torch.tensor([[1.0, 2.0], [3.0, 4.0]])
x.device # device(type='cpu')
```

### 梯度（Grad）

- **定义**: 在深度学习中，某些张量需要计算梯度以进行反向传播。
- **设置方法**: 在创建张量时，可以通过 `requires_grad=True` 来指定该张量需要梯度。
- **获取梯度信息**: 可以通过 `tensor.grad` 获取张量的梯度。

```python
import torch

x = torch.tensor([[1.0, 2.0], [3.0, 4.0]], requires_grad=True)

loss = x.sum()
loss.backward()

x.grad
'''
tensor([[1., 1.],
        [1., 1.]])
'''
```

### 内存布局（Memory Layout）

- **定义**: 张量的内存布局决定了数据在内存中的存储方式，如连续存储或稀疏存储。
- **常见布局**: 
  - `torch.strided`：密集张量的常用布局
  - `torch.sparse_coo`：稀疏张量的布局

```python
import torch

x = torch.tensor([[1.0, 2.0], [3.0, 4.0]])
x.layout # torch.strided
```




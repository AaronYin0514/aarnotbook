---
tags: python ai pytorch 
---

# 张量-属性

## Tensor的属性

| 属性           | 说明                                                              |
| -------------- | ----------------------------------------------------------------- |
| `torch.dtype`  | 类型                                                          |
| `torch.device` | 标识了`torch.Tensor`对象在创建之后所存储在的设备名称cpu/cuda(gpu) |
| `torch.layout` | 表示`torch.Tensor`内存布局的对象，稠密的和稀疏的                  |

### tensor的类型

|                         |                                   |                        |
| ----------------------- | --------------------------------- | ---------------------- |
| 32-bit floating point   | `torch.float32` or `torch.float`  | `torch.*.FloatTensor`  |
| 64-bit floating point   | `torch.float64` or `torch.double` | `torch.*.DoubleTensor` |
| 16-bit floating point   | `torch.float16` or `torch.half`   | `torch.*.HalfTensor`   |
| 8-bit integer(unsigned) | `torch.uint8`                     | `torch.*.ByteTensor`   |
| 8-bit integer(signed)   | `torch.int8`                      | `torch.*.CharTensor`   |
| 16-bit integer(signed)  | `torch.int16` or `torch.short`    | `torch.*.ShortTensor`  |
| 32-bit integer(signed)  | `torch.int32` or `torch.int`      | `torch.*.IntTensor`    |
| 64-bit integer(signed)  | `torch.int64`  or `torch.long`    | `torch.*.LongTensor`   |
| Boolean                 | `torch.bool`                      | `torch.BoolTensor`     |

```python
# 指定tensor类型
a = torch.tensor([2,2], dtype=torch.int32)
print(a) # tensor([2, 2], dtype=torch.int32)
```

### 设备

> 机器学习中的资源分配
> 
> - 数据读取和预处理，优先将数据放到cpu上计算
> - 数据推理，优先放到gpu上计算

```python
# 将变量指定到GPU上进行存储
dev = torch.device("cuda:0")
# 将变量指定到CPU上进行存储
dev = torch.device("cpu")
# Mac arm64芯片
dev = torch.device("mps")

a = torch.tensor([2,2], dtype=torch.int32, device=dev)
```

### 稀疏的张量

稀疏表示数据中0的个数，0越多，越稀疏

**优势**

- 稀疏的数据可以使模型变得简单，参数变少
- 减少在内存中的开销

**创建稀疏的张量**

> `torch.sparse_coo_tensor`
> 
> - 参数1: 非零元素的坐标形式
> - 参数2: 非零元素的具体值
> - 参数3: size
> - 其它：类型、设备等

```python
# 非零元素的坐标形式
i = torch.tensor([[0,1,2], [0,1,2]])
# 非零元素的具体值
v = torch.tensor([1,2,3])

# 稀疏的张量
a = torch.sparse_coo_tensor(i,v, (4,4))
print(a) 
'''
tensor(indices=tensor([[0, 1, 2],
                       [0, 1, 2]]),
       values=tensor([1, 2, 3]),
       size=(4, 4), nnz=3, layout=torch.sparse_coo)
'''

# 转换为稠密的张量
a = a.to_dense()
print(a)
'''
tensor([[1, 0, 0, 0],
        [0, 2, 0, 0],
        [0, 0, 3, 0],
        [0, 0, 0, 0]])
'''
```




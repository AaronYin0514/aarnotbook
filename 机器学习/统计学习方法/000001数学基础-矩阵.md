# 矩阵

在模型中矩阵和向量是数据的基本表示形式

## 基本概念

在数学上通常

- 使用$x_{i,j}$表示**标量**
- 使用$X_i$表示**向量**
- 使用$X$表示$n \times m$的**矩阵**
- 使用$R^{n \times m}$表示$n \times m$的**矩阵全体**

标量、向量和矩阵的**关系**如下

$$
X_i = (x_{i,1}, x_{i,1}, ... ,x_{i,m})
$$

$$
X =

\begin{pmatrix}
X_1 \\
X_2 \\
\vdots \\
X_n
\end{pmatrix}

= (x_{i,j}) \in R^{n \times m}
$$

若$m = n$，称为n维矩阵或**方阵**。

## 一些特殊矩阵

**单位矩阵**

$$
I_n =

\begin{pmatrix}
1 & 0 & ... & 0 \\
0 & 1 & ... & 0 \\
\vdots & \vdots & \ddots & \vdots \\
0 & 0 & ... & 1 \\
\end{pmatrix}

= (1_{\{i = i\}}) \in R^{n \times n}
$$

**对角矩阵**

$$
diag(d_1, d_2, ... ,d_n) =

\begin{pmatrix}
d_1 & 0 & ... & 0 \\
0 & d_2 & ... & 0 \\
\vdots & \vdots & \ddots & \vdots \\
0 & 0 & ... & d_n \\
\end{pmatrix}

\in R^{n \times n}
$$

**三角矩阵**

$$
\text{下三角矩阵} L =

\begin{pmatrix}
l_{1,1} & 0 & ... & 0 \\
l_{2,1} & l_{2,2} & ... & 0 \\
\vdots & \vdots & \ddots & \vdots \\
l_{n,1} & l_{n,2} & ... & l_{n,n} \\
\end{pmatrix}

\in R^{n \times n}
$$

$$
\text{上三角矩阵} U =

\begin{pmatrix}
u_{1,1} & u_{1,2} & ... & u_{1,n} \\
0 & u_{2,2} & ... & u_{2,n} \\
\vdots & \vdots & \ddots & \vdots \\
0 & 0 & ... & u_{n,n} \\
\end{pmatrix}

\in R^{n \times n}
$$

## 矩阵运算

### 加减法运算

加减法运算：要求两个矩阵的**形状（行数和列数）是相同的**

$$X = (x_{i,j}) \in R^{n \times m};$$

$$Y = (y_{i,j}) \in R^{n \times m};$$

$$
X \pm Y = 

\begin{pmatrix}
x_{1,1} \pm y_{1,1} & \dots & x_{1,m} \pm y_{1,m} \\
\vdots & \ddots & \vdots & \\
x_{n,1} \pm y_{n,1} & \dots & x_{n,m} \pm y_{n,m}
\end{pmatrix}
$$

矩阵加减法满足**交换律**和**结合律**

$X + Y = Y + X$

$X + Y + Z = X + (Y + Z)$

### 矩阵与数字的乘法

$$
kX = 
\begin{pmatrix}
kx_{1,1} & \dots & kx_{1,m} \\
\vdots & \ddots & \vdots & \\
kx_{n,1} & \dots & kx_{n,m}
\end{pmatrix}

= (kx_{i,j}) \in R^{n \times m}
$$

### 矩阵的乘法

![](../assets/imgs/ai/juzhenchenggfa.png)

#### 矩阵乘法

要求第**一个矩阵的列数**等于**第二个矩阵的行数**

$$A = (a_{i,j}) \in R^{n \times p}$$

$$B = (b_{i,j}) \in R^{p \times m}$$

$$
AB = (\sum_{r = 1}^{p}a_{i,r}b_{r,j}) \in R^{n \times m}
$$

矩阵的乘法满足**结合律**和**分配律**

$$(AB)C = A(BC)$$

$$A(B + C) = AB + AC$$

#### 按位乘法

要求两个矩阵的**形状相同**

$$
A \degree B = (a_{i,j}b_{i,j}) \in R^{n \times m}
$$

#### 矩阵的乘法可以极大地简化模型的表示

$$
f(x)=

\begin{cases}

y_1 = ax_1 + b\\
y_2 = ax_2 + b
 
\end{cases}
$$

$$
\text{令}X = 
\begin{pmatrix}
x_1 & 1 \\
x_2 & 1
\end{pmatrix}\text{，}

\beta = 
\begin{pmatrix}
a \\
b
\end{pmatrix}\text{，}

Y = 
\begin{pmatrix}
y_1 \\
y_2
\end{pmatrix}
$$

$$
Y = X\beta
$$

## 逆矩阵

如果对于**方阵**$M$，存在方阵$N$满足$MN = NM = I_n$，则称$N$为$M$的**逆矩阵**，记为

$$N = M^{-1}$$

**性质：**

$(M^{-1})^{-1} = M$

$(kM)^{-1} = \frac{1}{k} M^{-1}$

$(MN)^{-1} = N^{-1}M^{-1}$

## 转置

**定义**

$X = (x_{i,j}) \in R^{n \times m}$

$X^{T} = (x_{j,i}) \in R^{m \times n}$

**性质**

$(X^T)^T = X$

$(X + Y)^T = X^T + Y^T$

$(kX)^T = kX^T$

$(XY)^T = Y^TX^T$

$(X^T)^{-1} = (X^{-1})^T$

**对称矩阵**：$X^T = X$
















# 矩阵&行列式

## 行列式

**矩阵与行列式没有必然联系**

- 行列式必须是**方阵**，行列式是一个**标量**（数），行列式用$det(A)$或$|A|$表示
- 矩阵可以是**任意行数列数**，矩阵是一个**数表**，矩阵用**[]**表示

### 行列式的几何意义

- 二阶行列式表示了二维平面内以两个向量为邻边的平行四边形的面积；
- 三阶行列式表示了三维空间内以3个向量为邻边的平行六面体的体积；
- 推广到n维空间，n阶行列式表示在n维空间内以n个向量为邻边的图形的n维体积；

### 行列式的性质

- 性质0：单位矩阵的行列式为1
- 性质1：如何$Dn=det(A)$中某行元素全为0，那么$Dn=0$
- 性质2：如果$Dn=det(A)$中某两行元素对应成比例，那么$Dn=0$
- 性质3：如果$Dn=det(A)$中某两行互换，那么互换后的行列式变号，即$det(A)=-det(A')$
- 性质5：倍乘性质
- 性质6：倍加性质
- 性质7：以上所有作用于行的性质也可以作用于列上
- 性质8：两个矩阵相乘的行列式，等于两个矩阵行列式相乘

### 行列式的计算

#### 二阶行列式

$$
\begin{vmatrix}
a_{11} & a_{12} \\
a_{21} & a_{22}
\end{vmatrix}

= a_{11}a_{22} - a_{12}a_{21}
$$
#### 三阶行列式

$$
\begin{vmatrix}
a_{11} & a_{12} & a_{13} \\
a_{21} & a_{22} & a_{23} \\
a_{31} & a_{32} & a_{33}
\end{vmatrix}

= a_{11}a_{22}a_{33} + a_{12}a_{23}a_{31} + a_{13}a_{21}a_{32} - a_{13}a_{22}a_{31} - a_{12}a_{21}a_{33} - a_{11}a_{23}a_{32}
$$

![](matrix-times.png)

#### 转换方法(行列式化为上三角行列式)

n阶行列式化为上三角行列式，主对角线上元素的乘积即为行列式结果。

n阶行列式化为上三角行列式方法：

- 从左到右，依次将各列主对角线**之下**的元素全部变为0；
- 从第1列开始，将第1行分别乘以某个合适的数后加到第$2,3,\dots,n$行，从而将$a_{21},a_{31},\dots,a_{n1}$都变为0；
- 以此类推，将第i行分别乘以某个合适的数后加到第$i+1,i+2,\dots,n$行，从而将$a_{i+1,i},a_{i+2,i},\dots,a_{n,i}$都变为0；
- 上述过程到第n-1行后，即完成n阶行列式化为上三角行列式。

例题：

$$
计算：D =
\begin{vmatrix}
3 & 1 & -1 & 2 \\
-5 & 1 & 3 & -4 \\
2 & 0 & 1 & -1 \\
1 & -5 & 3 & -3
\end{vmatrix}
$$

解：

$$
D =
-\begin{vmatrix}
1 & 3 & -1 & 2 \\
1 & -5 & 3 & -4 \\
0 & 2 & 1 & -1 \\
-5 & 1 & 3 & -3
\end{vmatrix}

=

-\begin{vmatrix}
1 & 3 & -1 & 2 \\
0 & -8 & 4 & -6 \\
0 & 2 & 1 & -1 \\
0 & 16 & -2 & 7
\end{vmatrix}
$$

$$
=

\begin{vmatrix}
1 & 3 & -1 & 2 \\
0 & 2 & 1 & -1 \\
0 & -8 & 4 & -6 \\
0 & 16 & -2 & 7
\end{vmatrix}

=

\begin{vmatrix}
1 & 3 & -1 & 2 \\
0 & 2 & 1 & -1 \\
0 & 0 & 8 & -10 \\
0 & 0 & -10 & 15
\end{vmatrix}
$$

$$
=

\begin{vmatrix}
1 & 3 & -1 & 2 \\
0 & 2 & 1 & -1 \\
0 & 0 & 8 & -10 \\
0 & 0 & 0 & \frac{5}{2}
\end{vmatrix}

= 40
$$

## 矩阵

一个$m \times n$的**矩阵**是一个$m$行（row）$n$列（column）元素的矩形阵列。矩阵里的元素可以使数字或符号甚至是函数。

若$m = n$，称为n维矩阵或**方阵**。

**上三角矩阵**

$$
\begin{bmatrix}

a_{11} & a_{12} & \cdots & a_{1n} \\
0 & a_{22} & \cdots & a_{2n} \\
\vdots& \vdots & \ddots & \vdots \\
0 & 0 & \cdots & a_{nn}

\end{bmatrix}
$$

**下三角矩阵**

$$
\begin{bmatrix}

a_{11} & 0 & \cdots & 0 \\
a_{21} & a_{22} & \cdots & 0 \\
\vdots& \vdots & \ddots & \vdots \\
a_{n1} & a_{n2} & \cdots & a_{nn}

\end{bmatrix}
$$

**对角阵**

$$
\begin{bmatrix}

a_{11} & 0 & \cdots & 0 \\
0 & a_{22} & \cdots & 0 \\
\vdots& \vdots & \ddots & \vdots \\
0 & 0 & \cdots & a_{nn}

\end{bmatrix}
$$

**单位矩阵**：常用$I$，$U$或$E$来表示

$$
\begin{bmatrix}

1 & 0 & \cdots & 0 \\
0 & 1 & \cdots & 0 \\
\vdots& \vdots & \ddots & \vdots \\
0 & 0 & \cdots & 1

\end{bmatrix}
$$

**正交矩阵**：正交矩阵是一个方块矩阵Q。其元素为实数，而且行向量与列向量皆为正交的单位向量，使得该矩阵的转置矩阵为其逆矩阵：

$Q^T = Q^{-1} \Leftrightarrow Q^TQ = QQ^T = I$

其中，I为单位矩阵。正交矩阵的行列式值必定为+1或−1因为：

$1 = det(I) = det(Q^TQ) = det(Q^T)det(Q) = (det(Q))^2 \Rightarrow det(Q) = \pm1$

举例：

$$
\begin{bmatrix}
1 & 0 \\
0 & 1
\end{bmatrix}
$$

$$
\begin{bmatrix}
0 & -0.80 & -0.60 \\
0.80 & -0.36 & 0.48 \\
0.60 & 0.48 & -0.64
\end{bmatrix}
$$

### 矩阵运算

#### 加减法

两个$m \times n$的矩阵$A=(a_{ij}), B=(b_{ij})$

$$
A \pm B = 

\begin{bmatrix}
a_{11} \pm b_{11} & a_{12} \pm b_{12} & \cdots & a_{1n} \pm b_{1n} \\
a_{21} \pm b_{21} & a_{22} \pm b_{22} & \cdots & a_{2n} \pm b_{1n} \\
\vdots& \vdots & \ddots & \vdots \\
a_{m1} \pm b_{m1} & a_{m2} \pm b_{m2} & \cdots & a_{mn} \pm b_{mn} \\
\end{bmatrix}
$$

#### 数乘

$$
\lambda A = 

\begin{bmatrix}
\lambda a_{11} & \lambda a_{12} & \cdots & \lambda a_{1n} \\
\lambda a_{21} & \lambda a_{22} & \cdots & \lambda a_{2n} \\
\vdots& \vdots & \ddots & \vdots \\
\lambda a_{m1} & \lambda a_{m2} & \cdots & \lambda a_{mn} \\
\end{bmatrix}
$$

#### 矩阵乘法

矩阵A的列数和矩阵B的行数相等时才能定义。

A是$m \times n$矩阵，B是$n \times p$矩阵，乘积AB是一个$m \times p$矩阵

$$
[AB]_{ij} = \sum_{r=1}^{n}A_{i,r}B_{r,j}
$$
![](../assets/imgs/ai/juzhenchenggfa.png)

### 矩阵的秩

秩表示矩阵的极大线性无关组数量

### 矩阵的特征值和特征向量

对于给定矩阵A，寻找一个常数$\lambda$和非零向量$x$，使得向量$x$被矩阵A作用后所得的向量$Ax$与原向量$x$平行，并且满足$Ax = \lambda x$

式$Ax = \lambda x$也可以写成$(A - \lambda I)x = 0$。这是n个未知数n个方程的齐次线性方程组，它有非零解的充分必要条件是系数行列式$|A - \lambda I| = 0$

**特征值和特征向量的计算**

$$
\text{设}
A = 
\begin{bmatrix}
-2 & 1 & 1 \\
0 & 2 & 0 \\
-4 & 1 & 3 \\
\end{bmatrix}
\text{，求A的特征值与特征向量}
$$

解：

$$
|A - \lambda E| =

\begin{bmatrix}
-2 - \lambda & 1 & 1 \\
0 & 2 - \lambda & 0 \\
-4 & 1 & 3 - \lambda \\
\end{bmatrix}

= -(\lambda + 1)(\lambda - 2)^2
$$

$$
\text{令} -(\lambda + 1)(\lambda - 2)^2 = 0
$$

$$
\text{得A的特征值为} \lambda_1 = -1, \lambda_2 = \lambda_3 = 2
$$

$$
(1) 当\lambda_1 = -1时，解方程 (A + E)x = 0.由
$$

$$
A + E = 

\begin{bmatrix}
-1 & 1 & 1 \\
0 & 3 & 0 \\
-4 & 1 & 4 \\
\end{bmatrix}

\to

\begin{bmatrix}
1 & 1 & -1 \\
0 & 1 & 0 \\
0 & 0 & 0 \\
\end{bmatrix}
$$
$$
得基础解系 p_1 = (1,0,1)^T
$$

$$
故对应于 \lambda_1 = -1的全体特征向量为 kp_1(k \ne 0).
$$

$$
(2) 当\lambda_2 = \lambda_3 = 2时，解方程(A - 2E)x = 0.由
$$

$$
A - 2E = 

\begin{bmatrix}
-4 & 1 & 1 \\
0 & 0 & 0 \\
-4 & 1 & 1 \\
\end{bmatrix}

\to

\begin{bmatrix}
-4 & 1 & 1 \\
0 & 0 & 0 \\
0 & 0 & 0 \\
\end{bmatrix}
$$

$$
得基础解系 p_2 = (0,1,-1)^T, p_3 = (1,0,4)^T ,
$$

$$
所以对应于 \lambda_2 = \lambda_3 = 2 的全部特征向量为 k_2p_2 + k_3p_3 (k_2, k_3不同时为0)
$$

## SVD矩阵分解

奇异值分解可以用来分解任意形状的矩阵，不一定非要是方阵。

定义矩阵A的SVD为：$A = U \varSigma V^T$

- $U$（$m \times m$）和$V$（$n \times n$）是正交矩阵（酉矩阵），满足$U^TU = I, V^TV = I$，
- $\varSigma$（$m \times n$）是对角矩阵，对角线上的每个元素都成为**奇异值**

### SVD计算

定义矩阵A：

$$
\begin{bmatrix}
0 & 1 \\
1 & 1 \\
1 & 0 \\
\end{bmatrix}
$$

解：

首先求出$A^TA$和$AA^T$

$$
A^TA = 
\begin{bmatrix}
0 & 1 & 1 \\
1 & 1 & 0 \\
\end{bmatrix}
\begin{bmatrix}
0 & 1 \\
1 & 1 \\
1 & 0 \\
\end{bmatrix}

=
\begin{bmatrix}
2 & 1 \\
1 & 2 \\
\end{bmatrix}
$$

$$
AA^T = 
\begin{bmatrix}
0 & 1 \\
1 & 1 \\
1 & 0 \\
\end{bmatrix}
\begin{bmatrix}
0 & 1 & 1 \\
1 & 1 & 0 \\
\end{bmatrix}

=
\begin{bmatrix}
1 & 1 & 0 \\
1 & 2 & 1 \\
0 & 1 & 1 \\
\end{bmatrix}
$$

求出$A^TA$的特征值和特征向量：

$$
|A - \lambda E| =

\begin{bmatrix}
2 - \lambda & 1 \\
1 & 2 - \lambda \\
\end{bmatrix}

= (2 - \lambda)^2 - 1 = (\lambda - 3)(\lambda - 1) = 0
$$

所以$\lambda_1 = 3, \lambda_2 = 1$

> ⚠️：这里$\lambda_1 = 3, \lambda_2 = 1$需要由大到小排列

当$\lambda = 3$时

$$
A - 3E = 

\begin{bmatrix}
-1 & 1 \\
1 & -1 \\
\end{bmatrix}

\to

\begin{bmatrix}
-1 & 1 \\
0 & 0 \\
\end{bmatrix}
$$

求得$v_1 = (\frac{1}{\sqrt2}, \frac{1}{\sqrt2})^T$

> ⚠️：这里是对向量做单位化

$$
\lambda_1 = 3; 

v_1 = \begin{pmatrix}
\frac{1}{\sqrt2} \\
\frac{1}{\sqrt2} \\
\end{pmatrix}
$$

$$
\lambda_2 = 1; 

v_2 = \begin{pmatrix}
-\frac{1}{\sqrt2} \\
\frac{1}{\sqrt2} \\
\end{pmatrix}
$$

同理求出$AA^T$的特征值和特征向量：

$$
\lambda_1 = 3; 

u_1 = \begin{pmatrix}
\frac{1}{\sqrt6} \\
\frac{2}{\sqrt6} \\
\frac{1}{\sqrt6} \\
\end{pmatrix}
$$

$$
\lambda_2 = 1; 

u_2 = \begin{pmatrix}
\frac{1}{\sqrt2} \\
0 \\
-\frac{1}{\sqrt2} \\
\end{pmatrix}
$$

$$
\lambda_3 = 0; 

u_3 = \begin{pmatrix}
\frac{1}{\sqrt3} \\
-\frac{1}{\sqrt3} \\
\frac{1}{\sqrt3} \\
\end{pmatrix}
$$

求出奇异值$\sigma_i = \sqrt{\lambda_i}$

$$
\sigma_1 = \sqrt{\lambda_1} = \sqrt3
$$

$$
\sigma_2 = \sqrt{\lambda_2} = 1
$$

得到A的奇异值分解为：

$$
A = U \varSigma V^T =

\begin{bmatrix}
\frac{1}{\sqrt6} & \frac{1}{\sqrt2} & \frac{1}{\sqrt3} \\
\frac{2}{\sqrt6} & 0 & -\frac{1}{\sqrt3} \\
\frac{1}{\sqrt6} & -\frac{1}{\sqrt2} & \frac{1}{\sqrt3} \\
\end{bmatrix}

\begin{bmatrix}
\sqrt3 & 0 \\
0 & 1 \\
0 & 0 \\
\end{bmatrix}

\begin{bmatrix}
\frac{1}{\sqrt2} & \frac{1}{\sqrt2} \\
-\frac{1}{\sqrt2} & \frac{1}{\sqrt2} \\
\end{bmatrix}
$$









方差除以n-1是因为在现实采样是，例如正太分布数据，往往采集的数据是计较靠中间的，这样的数据导致样本方差偏小，除以n-1，而不是除以n，为了调整数据，使方差增大一些



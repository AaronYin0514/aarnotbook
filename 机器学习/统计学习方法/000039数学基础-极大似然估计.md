# 极大似然估计

极大似然估计是参数估计的一种方法，思想是未知参数取何值时，样本的观测值出现的概率最大。

## 举例

公务员考试往往不能一次性通过，下表表示在100人中，考了1次、2次、3次、4次以及大于4次才通过考试的人数。$X$为考试次数，求通过考试的概率$P$

|          |     |     |     |     |     |
| -------- | --- | --- | --- | --- | --- |
| 考试次数 | 1   | 2   | 3   | 4   | >4  |
| 通过人数 | 35  | 25  | 15  | 15  | 10  |

则$P(X=3)$表示3次通过考试的概率为

$$
P(X = 3) = (1 - P)(1 - P)P = (1 - P)^2P
$$

**方法1**

如果我们只知道$X=1$次通过的人数是35，其它的不知道

$$
P = P(X=1) = \frac{35}{100} = 0.35
$$

此方法依据**大数定律**。但是由于没有用到全部信息，所以$P$是**低估**了的

**方法2**

根据经验可知，数据服从几何分布$X \sim Geo(P)$，几何分布期望$E(X) = \frac{1}{P}$

$$
\frac{1}{P} = \bar{X} = 1 \times \frac{35}{90} + 2 \times \frac{25}{90} + 3 \times \frac{15}{90} + 4 \times \frac{15}{90} = \frac{190}{90}
$$

$$
\therefore P = \frac{90}{190} = 0.47
$$

为什么分母是90，因为剩余的10人，考试次数不确定，所以将这部分数据去掉。

这种方法叫**矩估计**，由于没有用到最后一列数据，所以结果是**高估**了的。


**方法3：MLE 极大似然估计**

思想：**出现即合理**

$$
L(P|X_1, X_2, \dots, X_{100}) = P(X_1, X_2, \dots, X_{100})
$$

单独一个样本$X_i$在第n次通过的概率：

$$
\begin{cases}
(1 - P)^{n - 1}P, & n = 1,2,3,4\\
(1 - P)^4, & n > 4
\end{cases}
$$

这里简化了$n > 4$的情况，认为没通过

如果$X_1 = 3, X_2 = 1$，那么

$P(X_1 = 3, X_2 = 1) = P(X_1 = 3)P(X_2 = 1) = (1 - P)^2P \times (1 - P)^0P$

所以

$$
\begin{align}
L(P) = P(X_1, X_2, \dots, X_{100}) & = P^{35}[(1 - P)P]^{25}[(1 - P)^2P]^{15}[(1 - P)^3P]^{15}[(1 - P)^4]^{10} \\
& = (1 - P)^{25 + 30 + 45 + 40}P^{35 + 25 + 15 + 15} \\
& = (1 - P)^{140}P^{90}
\end{align}
$$

最合理就是只这个事件出现的概率最大，即求极值

方法1，直接求导数

$$
\begin{align}
\frac{dL(P)}{dP} & = 140(1 - P)^{139}(-1)P^{90} + 90P^{89}(1 - P)^{140} \\
& = (1 - P)^{139}P^{89}(90 - 230P) = 0
\end{align}
$$

$P_1 = 1, P_2 = 0$不合理，所以取$P_3 \approx 0.39$

方法2，更常用的是求$ln$

$ln(L(P)) = ln(1 - P)^{140} + lnP^{90} = 140ln(1 - P) + 90lnP$

$\frac{dln(L(P))}{dP} = \frac{-140}{1 - P} + \frac{90}{P} = 0$

$P \approx 0.39$

**我们认为结果0.39更合理，因为它用到了全部信息。**












